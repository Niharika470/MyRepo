<!DOCTYPE html>
<html>
<head>
<title>Hospital</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script language="javascript">
    

    /*  function getDocsDetails() {
        // Creating the XMLHttpRequest object
        var request = new XMLHttpRequest();

        // Instantiating the request object
         var disease = document.getElementById("diseasename");
        var url = "http://localhost:9898/checkDoctorsAvailability/" +disease.value;
       
        request.open("GET", url,true);
        

        // Defining event listener for readystatechange event
        request.onreadystatechange = function() {
            // Check if the request is compete and was successful
            if(this.readyState === 4 && this.status === 200) {
                // Inserting the response from server into an HTML element
                //document.getElementById("result").innerHTML = this.responseText;
                console.log(this.responseText);
            }
        };

        // Sending the request to the server
        request.send();
    }  */
    var doctorId;
    var doctorName;
    var roomNo;
    var mobileNo;
    var name=null;
    var age=null;
    var gender=null;
    var addrs=null;
    var disease=null;
    
	     function getdocdetails() {
	    	var xmlhttp = new XMLHttpRequest();
	        var disease = document.getElementById("diseasename");
	       var url = "http://localhost:9898/checkDoctorsAvailability/" +disease.value;
	        xmlhttp.open('GET',url,true);
	       
	        
	        xmlhttp.onreadystatechange = function() {
	        	if (xmlhttp.readyState == 4) {
	                if ( xmlhttp.status == 200) {
	                	console.log( this.response); 
	               }
	        }
	        };
	        xmlhttp.responseType='json';
	        xmlhttp.send();
	         xmlhttp.onload=function(){
	        	 doctorId=xmlhttp.response.docId;
	        	 doctorName=xmlhttp.response.docName;
	        	 roomNo=xmlhttp.response.roomNo;
	        	console.log(doctorId);//101
	        	console.log(doctorName);
	        	console.log(roomNo);
	        	document.getElementById("docid").innerHTML = doctorId;
	        	document.getElementById("docname").innerHTML = doctorName;
	        	document.getElementById("roomno").innerHTML = roomNo; 
	        }
	    }
	     const data = JSON.stringify({
	    	    mob: "+919437496183",
	    	    name: "Hari",
	    	    age:25,
	    	    gender:"male",
	    	    address:"hyd",
	    	    disease:"fever"
	    	})

	    	const xhr = new XMLHttpRequest()
	     var mobileNo = document.getElementById("mob");
	     var name = document.getElementById("name");
	     var age = document.getElementById("age");
	     var gender = document.getElementById("gender");
	     var addrs = document.getElementById("address");
	     var disease = document.getElementById("disease");
	    	xhr.withCredentials = true

	    	xhr.addEventListener('readystatechange', function() {
	    	  if (this.readyState === this.DONE) {
	    	    console.log(this.responseText);
	    	  }
	    	})

	    	xhr.open('POST', 'https://localhost:9898/updatePatientDetails/'+mobileNo.value+name.value+age.value+
	    			gender.value+addrs.value+disease.value)
	    	xhr.setRequestHeader('content-type', 'application/json')
	    	xhr.setRequestHeader('authorization', 'Bearer 123abc456def')

	    	xhr.send(data);
	    	xhr.onload=function(){
	        	 mobileNo=xhr.response.mob;
	        	 name=xhr.response.name;
	        	 age=xhr.response.age;
	        	 gender=xhr.response.gender;
	        	 addrs=xhr.response.address;
	        	 disease=xhr.response.disease;
	        	console.log(mobileNo);
	        	console.log(name);
	        	console.log(age);
	        	console.log(gender);
	        	console.log(addrs);
	        	console.log(disease);
	        	
	        }
  
	     /* fetch('https://localhost:9898/updatePatientDetails/mobileno/name/age/gender/address/disease', {
	    	  method: 'POST',
	    	  headers: {
	    	    'content-type': 'application/json',
	    	    authorization: 'Bearer 123abc456def'
	    	  },
	    	  body: {
	    	    mobileno: "+919437496183",
	    	    name: "Hari",
	    	    age:25,
	    	    gender:"male",
	    	    address:"hyd",
	    	    disease:"fever"
	    	  }
	    	})
	    	  .then(response => {
	    	    console.log(response)
	    	  })
	    	  .catch(err => {
	    	    console.log(err)
	    	  })
	      */
      </script>
</head>
<body>
	<h2>Hospital Management System</h2>
	<hr />
	<form>
		<input id="diseasename" type="text" name="text" class="search"
			placeholder="disease" />
		<button type="button" onclick="getdocdetails()">Search</button>
		
		<input id="mob" id="name" id="age" id="gender" id="address" id="disease" type="number" name="text" class="submitdetails"
			placeholder="details" />
		<button type="button" >SubmitDetails</button>
		<table>
			<td>Doctor's Status:</td>
			<td>
           
				<!--  <p id="docid"></p> 
				<p id="docname"></p>
				<p id="roomno"></p>  -->
				
			</td>
		</table>
		<table>
			<tr>
				<th>Name</th>
				<td><input type="text" name=""></td>
				<th>Age</th>
				<td><input type="text" name=""></td>
                <th>Mob</th>
				<td><input type="number" name=""></td>
				<td><input type="radio" name="Gender">Male <input
					type="radio" name="Gender">Female</td>
			<tr>
				<td>Address</td>
				<td><input type="text" name=""></td>
			</tr>
			</tr>
		</table>
	</form>
</body>
</html>